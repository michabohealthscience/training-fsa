---
title: "Bioactivity-based grouping"
#subtitle: "Introductory practical experience in conducting omics-based grouping"
authors: "Michabo Health Science Ltd"
output: 
  html_document:
    toc: true
    toc_float: true
    toc_collapsed: true
    toc_depth: 3
    number_sections: false
link-citations: true
bibliography: references.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# t-statistic grouping
We have finally made it to the grouping!

For the Michabo Health Science workflow grouping we use the t-statistic calculated from the previous section. 

The benefit of using the t-statistic rather than for example the fold change is that variance is considered when comparing the means of the control and treated samples.


First get root URL for data
```{r root_dir_url}
root <- 'https://raw.githubusercontent.com/michabohealthscience/training-fsa/main'
```


```{r root_dir, echo=FALSE}
root <- '.'
```


```{r read_in_data_grouping}
tstats <- read.csv(file.path(root, 'data/combined_male_tstats.csv'), row.names = 1)

```



# Vector normalisation for each condition ('scaling')




```{r rscaling}
tstats_scaled <- scale(tstats, center=FALSE, scale=TRUE)
```


# t-stat - HCA
```{r HCA}
library(pvclust)
pvclust_res <- pvclust(tstats_scaled, method.dist="euclidean", method.hclust = "ward.D2", nboot=100)

plot(pvclust_res, c("si", "au", "bp"), hang=-1)


```





# References
